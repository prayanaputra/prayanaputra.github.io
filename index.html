<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spill Takdir Kelompok VIII.6 - INFORMATIKA </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&family=VT323&display=swap');

        :root {
            --bg-dark: #0a0a0a;
            --text-light: #f0f0f0;
            --neon-pink: #ff0099;
            --neon-blue: #00e5ff;
            --neon-green: #39FF14;
            --border-radius: 20px;
        }

        /* Tampilan Dasar */
        body {
            font-family: 'Poppins', sans-serif;
            background: var(--bg-dark);
            color: var(--text-light);
            background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.05) 1px, transparent 0);
            background-size: 20px 20px;
            padding-top: 2rem;
            padding-bottom: 2rem;
            min-height: 100vh;
        }

        /* Custom Scrollbar */
        body::-webkit-scrollbar { width: 10px; }
        body::-webkit-scrollbar-track { background: var(--bg-dark); }
        body::-webkit-scrollbar-thumb { background: var(--neon-pink); border-radius: 5px; border: 1px solid var(--neon-blue); }
        body::-webkit-scrollbar-thumb:hover { background: var(--neon-blue); box-shadow: 0 0 5px var(--neon-blue); }

        .screen {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 2.5rem;
            border-radius: var(--border-radius);
            border: 2px solid rgba(255, 255, 255, 0.1);
            animation: fadeIn 0.8s ease-out;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
        }
        h2 { font-size: 2.5rem; font-weight: 800; margin-top: 0; }
        .hidden { display: none !important; }

        /* --- LAYAR 1: INPUT NAMA --- */
        #name-entry-screen h2 {
            text-shadow: 0 0 15px var(--neon-pink), 0 0 25px var(--neon-pink);
            animation: flicker 1.5s infinite alternate;
        }
        #name-input {
            text-align: center;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--neon-blue);
            color: var(--text-light);
            font-size: 1.5rem;
            transition: all 0.3s;
        }
        #name-input:focus { box-shadow: 0 0 10px var(--neon-blue); }

        #submit-name-btn {
            background: var(--neon-pink);
            color: var(--bg-dark);
            font-weight: 700;
            box-shadow: 0 0 20px var(--neon-pink), 0 0 40px rgba(255, 0, 153, 0.5);
            transition: all 0.3s ease-in-out;
            border: none;
        }
        #error-message { color: var(--neon-pink); font-weight: 700; height: 20px; animation: glitch 0.3s infinite; }

        /* --- LAYAR LOADING & PRANK KUCING --- */
        #loading-header { color: var(--neon-blue); text-shadow: 0 0 10px var(--neon-blue); }
        .progress-bar { background-color: var(--neon-blue); box-shadow: 0 0 10px var(--neon-blue); }
        #cat-prank-screen { background: #000; border-color: var(--neon-green); box-shadow: 0 0 20px var(--neon-green); }
        #cat-prank-screen h3 { color: var(--neon-green); }

        /* --- JUMPSCARE HANTU (CSS BARU & LEBIH BAIK) --- */
        #jumpscare-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: #000;
            z-index: 99999;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.05s ease-in; /* Transisi super cepat */
            overflow: hidden; /* BARU */
        }
        #jumpscare-image { /* BARU */
            width: 100%;
            height: 100%;
            object-fit: cover;
            animation: shake 0.5s infinite;
        }
        @keyframes shake { /* BARU */
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }


        /* --- ANIMASI ROULETTE & HASIL --- */
        #roulette-display { border-bottom: 3px dashed var(--neon-pink); text-shadow: 0 0 5px var(--neon-pink); }
        .roulette-winner {
            color: var(--neon-green);
            text-shadow: 0 0 20px var(--neon-green), 0 0 40px rgba(57, 255, 20, 0.8);
            border-bottom: 3px solid var(--neon-green) !important;
        }
        #show-all-button {
            background: var(--neon-blue);
            color: var(--bg-dark);
            font-weight: 700;
            box-shadow: 0 0 20px var(--neon-blue);
            border: none;
        }
        
        /* --- MODAL KUIS (CSS BARU untuk WARNA) --- */
        .modal-content {
            background-color: #1a1a1a; /* Latar belakang lebih gelap */
            border: 2px solid var(--neon-blue);
            box-shadow: 0 0 20px var(--neon-blue);
        }
        #quiz-question {
            color: var(--text-light); /* Teks soal terang */
        }
        .quiz-option-btn {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-light); /* Teks pilihan terang */
            border: 1px solid var(--neon-blue);
            transition: all 0.2s ease;
        }
        .quiz-option-btn:hover {
            background: var(--neon-blue);
            color: var(--bg-dark);
        }
        .quiz-option-btn.selected { /* Saat dipilih */
            background: var(--neon-pink);
            color: var(--bg-dark);
            border-color: var(--neon-pink);
            box-shadow: 0 0 10px var(--neon-pink);
        }
        #submit-answer-btn {
            background: var(--neon-green);
            color: var(--bg-dark);
        }
        #quiz-feedback.correct { color: var(--neon-green); }
        #quiz-feedback.incorrect { color: var(--neon-pink); }


        /* --- KARTU KELOMPOK --- */
        .group-card { transition: all 0.3s ease; background-color: #111; }
        .personal-card { border: 3px solid var(--neon-blue); box-shadow: 0 0 40px var(--neon-blue); animation: bounceIn 1s ease-out; }
        /* Warna Grup (Tetap sama) */
        .group-1{--group-color:#4CAF50}.group-2{--group-color:#2196F3}.group-3{--group-color:#FFC107}.group-4{--group-color:#FF5722}.group-5{--group-color:#F44336}.group-6{--group-color:#9C27B0}.group-7{--group-color:#00BCD4}.group-8{--group-color:#673AB7}
        
        .card-header {
            background-color: var(--group-color);
            display: flex; /* BARU */
            align-items: center; /* BARU */
            gap: 10px; /* BARU */
        }
        .group-icon { /* BARU */
            width: 24px;
            height: 24px;
            fill: #fff;
        }
        .task-assignment { background-color: var(--group-color); }
        .group-card.exploded { animation: none; border-color: var(--neon-pink); box-shadow: 0 0 50px var(--neon-pink); transform: scale(1.1); }
        .list-group-item { background-color: transparent; color: var(--text-light); border-color: rgba(255,255,255,0.1); }
        .leader-badge { color: var(--neon-green); } /* BARU */


        /* --- KEYFRAMES --- */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes bounceIn { 0%{transform:scale(0.5);opacity:0} 60%{transform:scale(1.1);opacity:1} 100%{transform:scale(1)} }
        @keyframes flicker { 0%, 18%, 22%, 25%, 53%, 57%, 100% { text-shadow: 0 0 15px var(--neon-pink), 0 0 25px var(--neon-pink); opacity: 1; } 20%, 24%, 55% { text-shadow: none; opacity: 0.8; } }
        @keyframes glitch { 0%,100%{transform:translate(0,0)} 20%{transform:translate(-3px,3px)} 40%{transform:translate(3px,-3px)} 60%{transform:translate(-3px,-3px)} 80%{transform:translate(3px,3px)} }
        .glitch-active { animation: glitch 0.2s infinite; }
    </style>
</head>
<body>
    <div class="container" id="main-container">
        <div id="name-entry-screen" class="screen text-center">
            <h2 class="mb-4">âœ¨ SPILL TAKDIR VIII.6 - GLITCH EDITION âœ¨</h2>
            <p class="mb-4">Satu nama untuk menentukan nasib sekelompok. **Ketik nama lengkap atau nama panggilanmu.**</p>
            <input type="text" id="name-input" class="form-control form-control-lg" placeholder="Contoh: Putu, Diego, Edell, dll...">
            <button id="submit-name-btn" class="btn btn-lg mt-4 w-50">SPILL TAKDIRKU!</button>
            <p id="error-message" class="mt-3 text-uppercase"></p>
        </div>
    </div>
    
    <audio id="heartbeat-sound" preload="auto" src="https://github.com/google-gemini-demo/audios/raw/main/heartbeat.mp3"></audio>
    <audio id="glitch-sound" preload="auto" src="https://github.com/google-gemini-demo/audios/raw/main/glitch.wav"></audio>
    <audio id="typing-sound" preload="auto" src="https://github.com/google-gemini-demo/audios/raw/main/typing.mp3"></audio>
    <audio id="scream-sound" preload="auto" src="https://github.com/google-gemini-demo/audios/raw/main/horror-scream.mp3"></audio>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
    document.addEventListener('DOMContentLoaded', function () {
        // --- DATA KELAS VIII.6 (DIUBAH) ---
        const groupData = [
            { id: 1, name: "Pasukan Kuota Limit", leader: "Putu Adel Liana Putri", icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="group-icon"><path d="M7 14.5a7 7 0 1 1 5.456-2.529l.71-.71A8 8 0 1 0 7 16V0a1 1 0 0 1 1 1v1.5a1 1 0 0 1-2 0V1a1 1 0 0 1 1-1z"/></svg>`, members: ["Putu Adel Liana Putri", "I Made Arya Bagus Permana Putra", "Ni Kadek Ayu Nopita Sari", "I Gede Suartaka", "Komang Ratih Novita Tri Amanda"], task: "Poster A-1" },
            { id: 2, name: "Geng Wi-Fi Tetangga", leader: "Gusti Ayu Nadya Qurrota A'Yun", icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="group-icon"><path d="M15.384 6.115a.485.485 0 0 0-.047-.736C12.54 4.043 8.447 3 4.5 3S-3.54 4.043.663 5.379a.485.485 0 0 0-.048.736.518.518 0 0 0 .736.048c2.17-1.002 5.438-1.994 8.148-1.994s5.979.992 8.148 1.994a.518.518 0 0 0 .736-.048zM4.5 9a3.5 3.5 0 0 1 3.5 3.5c0 1.258-.654 2.334-1.616 2.885a.5.5 0 0 0-.368.818c.245.41.832.613 1.488.613a4.49 4.49 0 0 0 4.49-4.49 4.5 4.5 0 0 0-4.5-4.5zM2.5 12.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z"/></svg>`, members: ["Gusti Ayu Nadya Qurrota A'Yun", "Gede Dedi Afriyadi", "Komang Reyna Reynita", "I Made Wira Adi Kusuma", "Alvaro Defa Karuniawan"], task: "Infografis B-2" },
            { id: 3, name: "Divisi Lupa Save", leader: "I Gede Rahadi Verdika Dirga Yasa", icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="group-icon"><path d="M4.5 0h-2A1.5 1.5 0 0 0 1 1.5V14a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V3.5a1.5 1.5 0 0 0-1.5-1.5h-2.5a.5.5 0 0 1 0-1H11A1.5 1.5 0 0 0 9.5 0h-5zM9 1a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1H9zM3 14V1.5a.5.5 0 0 1 .5-.5h1V14H3zm1-13.5V14h1V.5H4z"/></svg>`, members: ["I Gede Rahadi Verdika Dirga Yasa", "Jessica Valencia Caroline", "Anak Agung Ayu Dinda Ishana Maheswari", "I Putu Sandika Angga Widnyana", "Pande Ni Kadek Dwik Cahayati"], task: "Flyer C-3" },
            { id: 4, name: "Klan Layar Retak", leader: "Kadek Dwi Cahyani", icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="group-icon"><path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path d="M13.5 3a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2a.5.5 0 0 1 .5-.5zm0 4a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-1 0v-5a.5.5 0 0 1 .5-.5zM2 5.5a.5.5 0 0 0 0 1h5.632l-1.83 4.27a.5.5 0 0 0 .894.46l2-4.5A.5.5 0 0 0 8.5 6H3.5a.5.5 0 0 0-.5-.5z"/></svg>`, members: ["Kadek Dwi Cahyani", "Marsha Dinda Anditha", "Candra Rahayu", "I Nyoman Yudana Arta", "Made Ariyuga Kristia"], task: "Poster A-2" },
            { id: 5, name: "Skuad Blue Screen", leader: "Gede Satria Mahestra", icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="group-icon"><path d="M14.5 0a1.5 1.5 0 0 1 1.5 1.5v13A1.5 1.5 0 0 1 14.5 16h-13A1.5 1.5 0 0 1 0 14.5v-13A1.5 1.5 0 0 1 1.5 0h13zM1.5 1a.5.5 0 0 0-.5.5v13a.5.5 0 0 0 .5.5h13a.5.5 0 0 0 .5-.5v-13a.5.5 0 0 0-.5-.5h-13z"/><path d="M4 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 4 4zm4 0a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zm4 0a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5z"/></svg>`, members: ["Gede Satria Mahestra", "Putri Belinda Kanahaya", "I Made Atsama Wirya", "Putu Eka Sudarsini", "M. Andika Septiawan"], task: "Infografis B-1" },
            { id: 6, name: "Tim Salah Kirim Chat", leader: "Edellwais Putri Handayani", icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="group-icon"><path d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm4.5 3.5a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2a.5.5 0 0 1 .5-.5zm3 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2a.5.5 0 0 1 .5-.5zm3 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2a.5.5 0 0 1 .5-.5z"/></svg>`, members: ["Edellwais Putri Handayani", "Jasmine Grechia Bohakamau", "Ni Ketut Gita Gayatri", "I Komang Bayu Arya Wiguna", "Sakha Daniswara Riswanto"], task: "Flyer C-2" },
            { id: 7, name: "Pejuang Dark Mode", leader: "Zanetta Ozwala Prasetya", icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="group-icon"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/></svg>`, members: ["Zanetta Ozwala Prasetya", "I Gede Agus Budiartawan", "Kadek Ragga Dwimas Wibawa", "Fitri Citra Dewi", "Ni Putu Risma Utari Yani"], task: "Poster A-3" },
            { id: 8, name: "Brigade Typo Nasional", leader: "Putu Gede Sindhu Putra", icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="group-icon"><path d="M1.5 2.5a.5.5 0 0 1 .5-.5h12a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-12a.5.5 0 0 1-.5-.5v-1zm1 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-1zm5 0a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5v-1zm-5 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm4 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm4 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm-4 2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm4 0a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-4a.5.5 0 0 1-.5-.5v-1z"/></svg>`, members: ["Putu Gede Sindhu Putra", "Komang Sri Astuti", "Diego Christian Ananta", "Ketut Nesa Kurnia Dewi", "Komang Niri Astriniasih"], task: "Infografis B-3" }
        ];

        const funFacts = ["Keringat kuda nil warnanya pink. (Serius!)", "Gurita punya 3 jantung. (Dua buat insang, satu buat badan.)", "Madu adalah satu-satunya makanan yang gak bisa basi. (Rahasia alam!)", "Suara bebek tidak menggema, dan gak ada yang tau kenapa. (Misteri Ilahi.)", "Kalau kamu teriak 8 tahun, energi suaramu cuma cukup buat manasin secangkir kopi. (Hemat tenaga.)", "Keyboard QWERTY diciptakan untuk memperlambat pengetikan. (Biar gak macet!)"];
        const glitchTexts = ["Bentar, servernya lagi makan seblak...", "AI-nya lagi curhat, sabar ya...", "Mencari sinyal ke Pluto...", "Anjir nge-lag, pasti ada yg mikirin mantan...", "Menghubungi jin Qorin...", "Memperbarui patch 1.0.8.6..."];
        const randomGroupNames = ["Kelompok Jomblo Estetika", "Divisi Rebahan Profesional", "Klub Anti Mandi Pagi", "Masterchef Gagal Move On", "Geng Mabar Sampai Subuh", "The Legendary Spongebob"];
        const quizData = [ { question: "CPU itu singkatan dari apa hayo?", options: ["Central Processing Unit", "Computer Personal Unit", "Control Power Unit"], correctAnswer: 0 }, { question: "Yang BUKAN termasuk perangkat input komputer adalah...", options: ["Mouse", "Keyboard", "Monitor"], correctAnswer: 2 }, { question: "RAM gunanya buat apa sih?", options: ["Nyetak dokumen", "Menyimpan data sementara", "Nonton YouTube"], correctAnswer: 1 }, { question: "1 Kilobyte (KB) itu sekitar berapa Byte?", options: ["100 Byte", "1024 Byte", "1 Juta Byte"], correctAnswer: 1 } ];
        
        let currentQuiz = {}, selectedAnswerIndex = -1;
        const mainContainer = document.getElementById('main-container');
        const sounds = {
            heartbeat: document.getElementById('heartbeat-sound'),
            glitch: document.getElementById('glitch-sound'),
            typing: document.getElementById('typing-sound'),
            scream: document.getElementById('scream-sound') // DIUBAH
        };

        // Fungsi utilitas untuk memutar audio
        function playSound(audioEl) { audioEl.currentTime = 0; audioEl.play().catch(e => console.error("Audio play failed:", e)); }
        function pauseSound(audioEl) { audioEl.pause(); audioEl.currentTime = 0; }
        function typeWriter(element, text, speed) { let i = 0; element.innerHTML = ""; const type = () => { if (i < text.length) { element.innerHTML += text.charAt(i); i++; setTimeout(type, speed); } }; type(); }

        /** DIUBAH: Mencari detail user (grup, nama, dan status leader). */
        function findUserDetails(inputName) {
            const inputWords = inputName.toLowerCase().split(/\s+/).filter(word => word.length > 2);
            if (inputWords.length === 0) return null;

            for (const group of groupData) {
                for (const member of group.members) {
                    const memberWords = member.toLowerCase().split(/\s+/);
                    if (inputWords.some(iWord => memberWords.some(mWord => mWord.includes(iWord)))) {
                        return { 
                            group: group,
                            memberName: member,
                            isLeader: member === group.leader
                        };
                    }
                }
            }
            return null;
        }

        async function startTheShow(userName) {
            document.getElementById('name-entry-screen').classList.add('hidden');
            const userDetails = findUserDetails(userName); // DIUBAH
            
            if (!userDetails) { // DIUBAH
                document.getElementById('error-message').textContent = "NAMA INI TIDAK TERDAFTAR! Coba nama panggilan/lengkap yang benar.";
                document.getElementById('name-entry-screen').classList.remove('hidden');
                return;
            }

            const userGroup = userDetails.group; // DIUBAH

            // Mulai Loading
            mainContainer.innerHTML += `
                <div id="loading-screen" class="screen text-center">
                    <p id="loading-header" class="mb-3">MENGKALIBRASI TAKDIR ${userName.toUpperCase()}...</p>
                    <div id="fun-fact"></div>
                    <div class="progress" style="height: 30px;">
                        <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 0%; font-size: 1rem;">0%</div>
                    </div>
                </div>
            `;
            
            playSound(sounds.heartbeat);

            const progressBar = document.getElementById('progress-bar');
            const funFactEl = document.getElementById('fun-fact');
            let progress = 0;
            let timeElapsed = 0;

            // FASE 1: Fun Fact (3 detik)
            let factInterval = setInterval(() => { funFactEl.textContent = "Fun Fact: " + funFacts[Math.floor(Math.random() * funFacts.length)]; }, 1500);
            while (timeElapsed < 3000) { progress = Math.min(30, Math.floor(timeElapsed / 100)); progressBar.style.width = `${progress}%`; progressBar.textContent = `${progress}%`; await new Promise(r => setTimeout(r, 50)); timeElapsed += 50; }

            // FASE 2: Glitch (3 detik)
            clearInterval(factInterval); playSound(sounds.glitch); mainContainer.classList.add('glitch-active');
            let glitchTextInterval = setInterval(() => { funFactEl.textContent = glitchTexts[Math.floor(Math.random() * glitchTexts.length)]; }, 800);
            let targetProgress = 70; let startProgress = progress; let startTime = timeElapsed;
            while (timeElapsed < 6000) {
                const elapsedSinceStart = timeElapsed - startTime;
                const newProgress = startProgress + Math.floor((targetProgress - startProgress) * (elapsedSinceStart / 3000));
                progress = Math.min(targetProgress, newProgress); progressBar.style.width = `${progress}%`; progressBar.textContent = `${progress}%`; await new Promise(r => setTimeout(r, 50)); timeElapsed += 50;
            }

            // FASE 3: Prank Kucing (4 detik)
            clearInterval(glitchTextInterval); mainContainer.classList.remove('glitch-active');
            pauseSound(sounds.glitch); playSound(sounds.typing); pauseSound(sounds.heartbeat);
            document.getElementById('loading-screen').classList.add('hidden');
            mainContainer.innerHTML += `
                <div id="cat-prank-screen" class="screen text-center">
                    <h3>[ Akses Diberikan ke Server Takdir ]</h3>
                    <pre id="cat-art" class="my-3">
  /\\_/\\
 ( o.o )
  > ^ <
                    </pre>
                    <h3 id="cat-text">ERROR CRITICAL! SERVER DIJAGA KUCING!</h3>
                </div>
            `;
              while (timeElapsed < 10000) { await new Promise(r => setTimeout(r, 50)); timeElapsed += 50; } // Progress di background
            await new Promise(r => setTimeout(r, 4000));
            
            // FASE 4: ROULETTE ANIMATION
            pauseSound(sounds.typing);
            document.getElementById('cat-prank-screen').classList.add('hidden');
            mainContainer.innerHTML += `
                <div id="roulette-screen" class="screen text-center">
                    <h2 class="mb-4">MENGUNDI TAKDIR KELOMPOKMU...</h2>
                    <div id="roulette-display" class="fs-1 fw-bold p-3">Pencarian Jodoh Kelompok...</div>
                </div>
            `;
            
            const rouletteDisplay = document.getElementById('roulette-display');
            let spinInterval = setInterval(() => {
                const randomGroup = groupData[Math.floor(Math.random() * groupData.length)];
                rouletteDisplay.innerHTML = `${randomGroup.icon} ${randomGroup.name}`; // DIUBAH
            }, 100);

            await new Promise(r => setTimeout(r, 5000));

            clearInterval(spinInterval);
            rouletteDisplay.innerHTML = `${userGroup.icon} ${userGroup.name}`; // DIUBAH
            rouletteDisplay.classList.add('roulette-winner');
            await new Promise(r => setTimeout(r, 2000));
            
            // TAMPILKAN HASIL AKHIR
            document.getElementById('roulette-screen').classList.add('hidden');
            const finalHTML = `
                <div id="main-content" class="text-center screen">
                    <div id="personal-reveal">
                        <h2 id="welcome-message" class="mb-5"></h2>
                        <div id="personal-card-container" class="d-flex justify-content-center mt-3"></div>
                        <button id="show-all-button" class="btn btn-lg mt-5">SPILL SEMUA KELOMPOK DONG! (Jawab Kuis dulu)</button>
                    </div>
                    <div id="spinner-container" class="hidden my-5"></div>
                    <div id="all-groups-reveal" class="hidden">
                        <h3 class="mt-5" style="color: var(--neon-green); text-shadow: 0 0 10px var(--neon-green);">ðŸ”¥ NAH, INI DIA DAFTAR LENGKAPNYA! Cekidot! ðŸ”¥</h3>
                        <div id="all-groups-container" class="row g-4 mt-3 justify-content-center"></div>
                    </div>
                </div>
            `;
            mainContainer.innerHTML += finalHTML;

            confetti({ particleCount: 150, spread: 90, origin: { y: 0.6 } });
            document.getElementById('personal-card-container').innerHTML = createGroupCardHTML(userGroup, true);
            
            const firstName = userName.split(' ')[0];
            // DIUBAH: Pesan sambutan beda untuk leader
            const welcomeText = userDetails.isLeader
                ? `SELAMAT, ${firstName.toUpperCase()}! KAMU ADALAH KETUA TIM!`
                : `ANJAY! ${firstName.toUpperCase()}, INI TAKDIRMU!`;
            typeWriter(document.getElementById('welcome-message'), welcomeText, 75);

            document.getElementById('show-all-button').addEventListener('click', () => displayQuiz(groupData));
        }
        
        // DIUBAH: Fungsi untuk membuat kartu, kini dengan logo dan penanda leader
        function createGroupCardHTML(group, isPersonal = false) {
              const membersHTML = group.members.map(member => {
                  const isLeader = member === group.leader;
                  return `<li class="list-group-item ${isLeader ? 'leader-badge' : ''}">${isLeader ? 'ðŸ‘‘ ' : ''}${member}</li>`;
              }).join('');
              return `
                  <div class="col">
                       <div class="card group-card ${isPersonal ? 'personal-card' : ''} group-${group.id} rounded-4" style="width: 100%; max-width: 350px; margin: auto;">
                           <div class="card-header fw-bold">${group.icon} ${group.name}</div>
                           <div class="card-body p-0">
                               <ul class="list-group list-group-flush">${membersHTML}</ul>
                           </div>
                           <div class="card-footer task-assignment text-uppercase">${group.task}</div>
                       </div>
                  </div>`;
        }
        
        // --- QUIZ LOGIC ---

        function displayQuiz(allGroups) {
            if (!document.getElementById('quizModal')) {
                  mainContainer.insertAdjacentHTML('beforeend', `
                      <div class="modal fade" id="quizModal" tabindex="-1">
                          <div class="modal-dialog modal-dialog-centered">
                              <div class="modal-content text-light">
                                  <div class="modal-header border-0"><h5 class="modal-title w-100 text-center">âš¡ KUIS DADAKAN TEKNOLOGI! âš¡</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div>
                                  <div class="modal-body text-center">
                                      <p>Jawab dulu ini sebelum kepoin semua kelompok! Buktikan kalian gak gaptek!</p>
                                      <p id="quiz-question" class="h5 my-4"></p>
                                      <div id="quiz-options" class="d-grid gap-3"></div>
                                      <p id="quiz-feedback" class="mt-4 fw-bold"></p>
                                  </div>
                                  <div class="modal-footer justify-content-center border-0"><button id="submit-answer-btn" class="btn btn-lg w-75">Jawab!</button></div>
                              </div>
                          </div>
                      </div>
                  `);
            }
            selectedAnswerIndex = -1;
            currentQuiz = quizData[Math.floor(Math.random() * quizData.length)]; // Pilih kuis random
            document.getElementById('quiz-question').textContent = currentQuiz.question;
            const optionsContainer = document.getElementById('quiz-options');
            optionsContainer.innerHTML = '';
            currentQuiz.options.forEach((option, index) => { optionsContainer.innerHTML += `<button class="btn quiz-option-btn" data-index="${index}">${option}</button>`; });
            
            const quizModal = new bootstrap.Modal(document.getElementById('quizModal'));
            quizModal.show();

            document.getElementById('submit-answer-btn').onclick = () => handleSubmitAnswer(allGroups, quizModal);
            optionsContainer.onclick = handleQuizOptionClick;
            document.getElementById('quiz-feedback').textContent = '';
            document.getElementById('quiz-feedback').className = 'mt-4 fw-bold';
        }

        function handleQuizOptionClick(e) {
            if (e.target.classList.contains('quiz-option-btn')) {
                document.querySelectorAll('.quiz-option-btn').forEach(btn => btn.classList.remove('selected'));
                e.target.classList.add('selected');
                selectedAnswerIndex = parseInt(e.target.dataset.index);
            }
        }
        
        function handleSubmitAnswer(allGroups, modalInstance) {
            if (selectedAnswerIndex === -1) {
                document.getElementById('quiz-feedback').textContent = "Pilih salah satu jawaban dulu, Boss!";
                document.getElementById('quiz-feedback').className = 'mt-4 fw-bold incorrect';
                return;
            }
            const feedbackEl = document.getElementById('quiz-feedback');
            const isCorrect = selectedAnswerIndex === currentQuiz.correctAnswer;
            
            feedbackEl.className = isCorrect ? 'mt-4 fw-bold correct' : 'mt-4 fw-bold incorrect';
            feedbackEl.textContent = isCorrect ? "CAKEP BENER! Akses Diberikan!" : "YAH, SALAH! Akses Tetap Diberikan!";
            
            setTimeout(() => {
                // DIUBAH: Memulai Jumpscare yang sudah ditingkatkan
                startJumpscare(modalInstance, allGroups);
            }, 1500); // Waktu tunggu sedikit lebih cepat
        }

        // --- DIUBAH: FUNGSI JUMPSCARE BARU DENGAN GAMBAR & SUARA ---
        async function startJumpscare(modalInstance, allGroups) {
            modalInstance.hide();
            
            const jumpscareScreen = document.createElement('div');
            jumpscareScreen.id = 'jumpscare-screen';
            
            jumpscareScreen.innerHTML = `
                <img id="jumpscare-image" src="https://i.imgur.com/8zMAX0h.jpeg" alt="Jumpscare Image">
            `;
            document.body.appendChild(jumpscareScreen);
            
            // Jumpscare ON
            playSound(sounds.scream); // Mainkan suara teriakan
            jumpscareScreen.style.opacity = 1;

            await new Promise(r => setTimeout(r, 700)); // Tampilkan lebih singkat agar lebih kaget
            
            // Jumpscare OFF
            jumpscareScreen.style.opacity = 0;
            pauseSound(sounds.scream);

            await new Promise(r => setTimeout(r, 200)); // Transisi hilang
            document.body.removeChild(jumpscareScreen);
            
            // Lanjutkan ke tampilan kelompok
            startSpinnerAnimation(allGroups);
        }

        async function startSpinnerAnimation(allGroups) {
            document.getElementById('show-all-button').classList.add('hidden');
            const personalReveal = document.getElementById('personal-reveal');
            const spinnerContainer = document.getElementById('spinner-container');
            
            personalReveal.classList.add('hidden');
            spinnerContainer.classList.remove('hidden');

            spinnerContainer.innerHTML = `
                <h3 class="mb-4 text-center" style="color: var(--neon-pink); text-shadow: 0 0 10px var(--neon-pink);">
                    MENGACAK TAKDIR TEMAN-TEMANMU...
                </h3>
                <div id="spinner-card-area" class="d-flex justify-content-center"></div>
            `;
            const spinnerCardArea = document.getElementById('spinner-card-area');

            let spinInterval = setInterval(() => {
                const randomGroup = allGroups[Math.floor(Math.random() * allGroups.length)];
                const tempGroup = {...randomGroup, name: randomGroupNames[Math.floor(Math.random() * randomGroupNames.length)] };
                spinnerCardArea.innerHTML = createGroupCardHTML(tempGroup);
            }, 100);

            await new Promise(r => setTimeout(r, 4500));
            
            clearInterval(spinInterval);
            const finalGroup = allGroups[Math.floor(Math.random() * allGroups.length)];
            spinnerCardArea.innerHTML = createGroupCardHTML(finalGroup);
            
            const finalCard = spinnerCardArea.querySelector('.group-card');
            if(finalCard) finalCard.classList.add('exploded');

            await new Promise(r => setTimeout(r, 1000));

            spinnerContainer.classList.add('hidden');
            const allGroupsReveal = document.getElementById('all-groups-reveal');
            allGroupsReveal.classList.remove('hidden');
            
            const allGroupsContainer = document.getElementById('all-groups-container');
            allGroupsContainer.innerHTML = '';
            // Tampilkan semua grup dengan efek delay
            allGroups.forEach((group, index) => {
                setTimeout(() => {
                    const col = document.createElement('div');
                    col.className = 'col-lg-4 col-md-6 col-sm-12 d-flex';
                    col.innerHTML = createGroupCardHTML(group);
                    allGroupsContainer.appendChild(col);
                }, index * 200);
            });
        }
        
        document.getElementById('submit-name-btn').addEventListener('click', () => {
            const nameInput = document.getElementById('name-input').value.trim();
            if (nameInput === "") {
                document.getElementById('error-message').textContent = "ISI NAMA DULU, BESTIE!";
                return;
            }
            startTheShow(nameInput);
        });

    });
    </script>
</body>
</html>
